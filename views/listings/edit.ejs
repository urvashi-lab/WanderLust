<% layout('/layouts/boilerplate') %>
<style>
  img{
    height:300px;
    width:300px;
  }
</style>
<body>
    <div class="row">
        <div class="col-8 offset-3">
            <br/>
    <h3>Your listing</h3>
    <form method="POST" 
    action="/listings/<%=yourlisting._id%>?_method=PUT" 
    class="needs-validation"
     novalidate
     enctype="multipart/form-data">  
<div class="mb-3">  
<label for="title" class="form-label">Title</label> 
<input name="listing[title]" class="form-control" value="<%=yourlisting.title %>" type="text" required/>
<div class="invalid-feedback">Please provide a Title.</div>
</div> 
<div class="mb-3">
<label for="description" class="form-label">Description</label> 
<textarea name="listing[description]" class="form-control"  type="text" required><%=yourlisting.description %></textarea>
<div class="invalid-feedback">Please provide a Description.</div>
</div>
<div class="mb=3">
  Original Listing Image<br/>
  <img src="<%= originalImageUrl%>" >
  <br/><br/>
</div>

<div class="mb-3">
    <label for="image" class="form-label">Upload New Image</label> 
<input name="listing[image][url]"
 value="<%=yourlisting.image.url %>"
  class="form-control" type="file" />
<div class="invalid-feedback">Please provide a valid url for image.</div>
</div>

<div class="dropup mb-3">
  <button 
    class="btn btn-secondary dropdown-toggle" 
    type="button" 
    id="dropdownInputButton" 
    data-bs-toggle="dropdown" 
    aria-expanded="false">
    <%=yourlisting.category %>
  </button>
  <ul class="dropdown-menu" aria-labelledby="dropdownInputButton">
    <li class="dropdown-item" data-value="Amazing pools">Amazing pools</li>
    <li class="dropdown-item" data-value="Top cities">Top Cities</li>
    <li class="dropdown-item" data-value="Rooms">Rooms</li>
    <li class="dropdown-item" data-value="Mountains">Mountains</li>
    <li class="dropdown-item" data-value="Camping">Camping</li>
    <li class="dropdown-item" data-value="Farms">Farms</li>
    <li class="dropdown-item" data-value="Arctic">Arctic</li>
    <li class="dropdown-item" data-value="Forests">Forests</li>
   <li class="dropdown-item" data-value="History">History</li>
     <li class="dropdown-item" data-value="Greenary">Greenary</li>
     <li class="dropdown-item" data-value="Beaches">Beaches</li>
     <li class="dropdown-item" data-value="Lakefront">Lakefront</li>
     
     <li class="dropdown-item" data-value="Trending">Trending</li>
  
  </ul>
  <!-- Hidden input with name parameter for form submission -->
  <input type="hidden" name="listing[category]" value="<%=yourlisting.category%>" id="dropdownInput">
</div>

<div class="mb-3">
    <label for="location" class="form-label">Location</label> 
<input name="listing[location]" value="<%=yourlisting.location %>" class="form-control" type="text" required/>
<div class="invalid-feedback">Please provide a location.</div>
</div>
<div class="row">
<div class="mb-3 col-md-4"">
    <label for="price" class="form-label">Price</label> 
<input name="listing[price]" value="<%=yourlisting.price %>" class="form-control" type="number" required/>
<div class="invalid-feedback">Please provide price.</div>
</div>
<div class="mb-3 col-md-8">
    <label for="country" class="form-label">Country</label> 
<input name="listing[country]" value="<%=yourlisting.country %>" class="form-control" type="text" required/>
<div class="invalid-feedback">Please provide a country.</div>
</div>
</div>

<button class="btn btn-dark add-btn">Edit</button>

    </form>
</div>
</div>
<script>
        
    (function () {
      'use strict'
    
      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      const forms = document.querySelectorAll('.needs-validation')
    
      // Loop over them and prevent submission
      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault()
            event.stopPropagation()
          }
    
          form.classList.add('was-validated')
        }, false)
      })
    })()
        </script>
         <script>
          // Dropdown selection logic
  const dropdownItems = document.querySelectorAll('.dropdown-item');
  const dropdownButton = document.querySelector('#dropdownInputButton');
  const hiddenInput = document.querySelector('#dropdownInput');
  
  dropdownItems.forEach(item => {
  item.addEventListener('click', function () {
  const selectedValue = this.getAttribute('data-value'); // Get the value from data-value
  dropdownButton.textContent = selectedValue; // Update button text with selected value
  hiddenInput.value = selectedValue; // Update hidden input value for form submission
  });
  });
  </script>
</body>
